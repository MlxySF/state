<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 Wushu Registration | Legal Form</title>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Noto+Sans+SC:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <!-- jsPDF + html2canvas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <style>
        body {
            font-family: 'Inter', 'Noto Sans SC', sans-serif;
            background: radial-gradient(circle at top right, #1e293b, #0f172a);
            min-height: 100vh;
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        .step-content {
            display: none;
            animation: fadeIn 0.4s ease-in-out;
        }
        .step-content.active { display: block; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .sig-box {
            position: relative;
            width: 100%;
            height: 200px;
            border: 2px dashed #cbd5e1;
            border-radius: 0.75rem;
            background: #fff;
            overflow: hidden;
            touch-action: none;
        }
        
        #sig-placeholder {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #cbd5e1;
            font-size: 24px;
            font-weight: 700;
            pointer-events: none;
            user-select: none;
        }

        .custom-scroll::-webkit-scrollbar { width: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: #f1f5f9; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }

        /* Hidden PDF template */
        #pdf-template {
            width: 794px;
            padding: 40px;
            background: #ffffff;
            position: fixed;
            top: -10000px;
            left: -10000px;
            visibility: hidden;
            pointer-events: none;
            color: #111827;
            font-family: 'Noto Sans SC', sans-serif;
        }
        
        .pdf-header-img { width: 100%; margin-bottom: 12px; }
        .pdf-title-main { text-align:center; font-size:24px; font-weight:800; margin-top:6px; }
        .pdf-sub { text-align:center; font-size:13px; color:#6b7280; margin-bottom:24px; }
        .pdf-section { margin-bottom:22px; }
        .pdf-sec-title {
            background:#e5e7eb;
            padding:7px 12px;
            font-weight:700;
            font-size:13px;
            text-transform:uppercase;
        }
        .pdf-sec-body {
            border:1px solid #e5e7eb;
            border-top:none;
            padding:10px 12px;
            font-size:13px;
            line-height:1.5;
        }
        .pdf-row { margin-bottom:5px; }
        .pdf-label { font-weight:600; color:#6b7280; display:inline-block; width:140px; }
        .pdf-val { font-weight:500; color:#111827; }
        @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}
/* Custom Checkbox Styling */
.custom-checkbox {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    cursor: pointer;
    padding: 12px;
    border-radius: 8px;
    transition: background-color 0.2s;
}

.custom-checkbox:hover {
    background-color: #f8fafc;
}

.custom-checkbox input[type="checkbox"] {
    appearance: none;
    -webkit-appearance: none;
    width: 20px;
    height: 20px;
    min-width: 20px;
    border: 2px solid #cbd5e1;
    border-radius: 4px;
    cursor: pointer;
    position: relative;
    transition: all 0.2s;
    margin-top: 2px;
}

.custom-checkbox input[type="checkbox"]:hover {
    border-color: #7c3aed;
}

.custom-checkbox input[type="checkbox"]:checked {
    background-color: #7c3aed;
    border-color: #7c3aed;
}

.custom-checkbox input[type="checkbox"]:checked::after {
    content: '';
    position: absolute;
    left: 5px;
    top: 2px;
    width: 5px;
    height: 10px;
    border: solid white;
    border-width: 0 2px 2px 0;
    transform: rotate(45deg);
}

.custom-checkbox-label {
    flex: 1;
    line-height: 1.5;
}

    </style>
</head>
<body class="flex items-center justify-center p-4">

<div class="glass-card w-full max-w-3xl rounded-3xl overflow-hidden relative flex flex-col h-[90vh] md:h-auto md:min-h-[800px]">
    
    <!-- Header -->
    <div class="bg-slate-900 text-white p-6 border-b-4 border-amber-400">
        <div class="flex justify-between items-end mb-2">
            <div>
                <h1 class="text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-amber-200 to-amber-500">
                    2026 æ­¦æœ¯è®­ç»ƒæŠ¥å
                </h1>
                <p class="text-slate-400 text-xs tracking-wider uppercase">Official Registration Form</p>
            </div>
            <div class="text-amber-400 font-bold text-xl" id="step-counter">
                01<span class="text-slate-600 text-sm">/06</span>
            </div>
        </div>
        <div class="w-full bg-slate-700 h-1.5 rounded-full overflow-hidden mt-2">
            <div id="progress-bar" class="h-full bg-amber-400 transition-all duration-500 ease-out w-1/6"></div>
        </div>
    </div>

    <!-- Form body -->
    <div class="flex-1 overflow-y-auto custom-scroll p-6 md:p-8 bg-slate-50">
        <form id="regForm" onsubmit="return false;">
            
            <!-- STEP 1: Basic Info -->
<div id="step-1" class="step-content active">
    <h2 class="text-xl font-bold text-slate-800 mb-6 flex items-center gap-2">
        <i class="fa-solid fa-user-graduate text-amber-500"></i> åŸºæœ¬èµ„æ–™ Student Details
    </h2>
    <div class="space-y-6">
        <!-- Name Row -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="space-y-2">
                <label class="text-xs font-bold text-slate-500 uppercase">Chinese Name ä¸­æ–‡å</label>
                <input type="text" id="name-cn" class="w-full p-3 rounded-xl border border-slate-300 focus:border-amber-500 outline-none" placeholder="å¼ ä¸‰">
            </div>
            <div class="space-y-2">
                <label class="text-xs font-bold text-slate-500 uppercase">English Name è‹±æ–‡å</label>
                <input type="text" id="name-en" class="w-full p-3 rounded-xl border border-slate-300 focus:border-amber-500 outline-none" placeholder="Tan Ah Meng">
            </div>
        </div>

        <!-- IC and Age Row -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="space-y-2">
                <label class="text-xs font-bold text-slate-500 uppercase">IC Number èº«ä»½è¯å·ç </label>
                <input type="text" id="ic" class="w-full p-3 rounded-xl border border-slate-300 focus:border-amber-500 outline-none" placeholder="000000-00-0000" maxlength="14" oninput="calculateAge()">
                <p class="text-xs text-slate-400">Format: 000000-00-0000</p>
            </div>
            <div class="space-y-2">
                <label class="text-xs font-bold text-slate-500 uppercase">Age å¹´é¾„ (2026)</label>
                <input type="number" id="age" class="w-full p-3 rounded-xl border border-slate-300 bg-slate-100 text-slate-500 cursor-not-allowed outline-none" placeholder="Auto-calculated" readonly>
                <p class="text-xs text-slate-400">
                    <i class="fas fa-info-circle mr-1"></i>Calculated from IC
                </p>
            </div>
        </div>

        <!-- School Row -->
        <div class="space-y-2">
            <label class="text-xs font-bold text-slate-500 uppercase">School å­¦æ ¡</label>
            <select id="school" onchange="toggleOtherSchool()" class="w-full p-3 rounded-xl border border-slate-300 focus:border-amber-500 outline-none bg-white">
                <option value="">Select School...</option>
                <option value="SJK(C) PUAY CHAI 2">SJK(C) PUAY CHAI 2 (åŸ¹æ‰äºŒæ ¡)</option>
                <option value="SJK(C) Chee Wen">SJK(C) Chee Wen</option>
                <option value="SJK(C) Subang">SJK(C) Subang</option>
                <option value="SJK(C) Sin Ming">SJK(C) Sin Ming</option>
                <option value="Others">Others (å…¶ä»–)</option>
            </select>
            <input type="text" id="school-other" class="hidden w-full mt-2 p-3 rounded-xl border border-slate-300 focus:border-amber-500 outline-none" placeholder="Please specify school name">
        </div>
    </div>
</div>


            <!-- STEP 2: Contact -->
            <div id="step-2" class="step-content">
                <h2 class="text-xl font-bold text-slate-800 mb-6 flex items-center gap-2">
                    <i class="fa-solid fa-address-card text-amber-500"></i> è”ç³»æ–¹å¼ Contact Info
                </h2>
                <div class="space-y-5">
                    <div class="space-y-2">
                        <label class="text-xs font-bold text-slate-500 uppercase">Phone Number ç”µè¯å·ç </label>
                        <div class="relative">
                            <i class="fa-solid fa-phone absolute left-4 top-4 text-slate-400"></i>
                            <input type="tel" id="phone" class="w-full pl-10 p-3 rounded-xl border border-slate-300 focus:border-amber-500 outline-none" placeholder="012-345 6789" maxlength="13">
                        </div>
                        <p class="text-xs text-slate-400">Format: 012-345 6789 or 011-2345 6789</p>
                    </div>
                    <div class="space-y-2">
                        <label class="text-xs font-bold text-slate-500 uppercase">Parent's Email å®¶é•¿é‚®ç®±</label>
                        <div class="relative">
                            <i class="fa-solid fa-envelope absolute left-4 top-4 text-slate-400"></i>
                            <input type="email" id="email" class="w-full pl-10 p-3 rounded-xl border border-slate-300 focus:border-amber-500 outline-none" placeholder="parent@example.com">
                        </div>
                    </div>
                    <div class="space-y-2">
    <label class="text-xs font-bold text-slate-500 uppercase">Student Status èº«ä»½</label>
    <div class="grid grid-cols-3 gap-3">
        <label class="cursor-pointer">
            <input type="radio" name="status" value="Student å­¦ç”Ÿ" class="peer hidden" checked>
            <div class="p-3 text-center rounded-xl border border-slate-200 bg-white peer-checked:bg-slate-800 peer-checked:text-white transition-all">
                Student<br>å­¦ç”Ÿ
            </div>
        </label>
        <label class="cursor-pointer">
            <input type="radio" name="status" value="State Team å·é˜Ÿ" class="peer hidden">
            <div class="p-3 text-center rounded-xl border border-slate-200 bg-white peer-checked:bg-amber-500 peer-checked:text-white transition-all">
                State Team<br>å·é˜Ÿ
            </div>
        </label>
        <label class="cursor-pointer">
            <input type="radio" name="status" value="Backup Team åå¤‡é˜Ÿ" class="peer hidden">
            <div class="p-3 text-center rounded-xl border border-slate-200 bg-white peer-checked:bg-blue-600 peer-checked:text-white transition-all">
                Backup Team<br>åå¤‡é˜Ÿ
            </div>
        </label>
    </div>
</div>

                </div>
            </div>

            <!-- STEP 3: Events -->
            <div id="step-3" class="step-content">
                <h2 class="text-xl font-bold text-slate-800 mb-6 flex items-center gap-2">
                    <i class="fa-solid fa-trophy text-amber-500"></i> é¡¹ç›®é€‰æ‹© Event Selection
                </h2>
                
                <div class="mb-4">
                    <p class="text-sm text-slate-600 mb-4">Select events for each level (You can select multiple events across different levels)</p>
                </div>

                <div class="space-y-4">
                    <!-- Basic Level -->
                    <div class="border-l-4 border-slate-700 bg-slate-50 rounded-r-xl p-4">
                        <h3 class="font-bold text-slate-800 mb-3">åŸºç¡€ Basic</h3>
                        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2">
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="åŸºç¡€-é•¿æ‹³" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">é•¿æ‹³</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="åŸºç¡€-å—æ‹³" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å—æ‹³</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="åŸºç¡€-å¤ªææ‹³" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å¤ªææ‹³</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="åŸºç¡€-å‰‘" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å‰‘</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="åŸºç¡€-æª" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">æª</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="åŸºç¡€-åˆ€" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">åˆ€</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="åŸºç¡€-æ£" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">æ£</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="åŸºç¡€-å—åˆ€" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å—åˆ€</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="åŸºç¡€-å—æ£" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å—æ£</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="åŸºç¡€-å¤ªæå‰‘" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å¤ªæå‰‘</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="åŸºç¡€-å¤ªææ‰‡" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å¤ªææ‰‡</span>
                            </label>
                        </div>
                    </div>

                    <!-- Junior Level -->
                    <div class="border-l-4 border-blue-600 bg-blue-50 rounded-r-xl p-4">
                        <h3 class="font-bold text-blue-800 mb-3">åˆçº§ Junior</h3>
                        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2">
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="åˆçº§-é•¿æ‹³" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">é•¿æ‹³</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="åˆçº§-å—æ‹³" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å—æ‹³</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="åˆçº§-å¤ªææ‹³" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å¤ªææ‹³</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="åˆçº§-å‰‘" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å‰‘</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="åˆçº§-æª" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">æª</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="åˆçº§-åˆ€" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">åˆ€</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="åˆçº§-æ£" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">æ£</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="åˆçº§-å—åˆ€" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å—åˆ€</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="åˆçº§-å—æ£" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å—æ£</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="åˆçº§-å¤ªæå‰‘" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å¤ªæå‰‘</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="åˆçº§-å¤ªææ‰‡" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å¤ªææ‰‡</span>
                            </label>
                        </div>
                    </div>

                    <!-- Group B -->
                    <div class="border-l-4 border-green-600 bg-green-50 rounded-r-xl p-4">
                        <h3 class="font-bold text-green-800 mb-3">Bç»„ Group B</h3>
                        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2">
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="Bç»„-é•¿æ‹³" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">é•¿æ‹³</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="Bç»„-å—æ‹³" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å—æ‹³</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="Bç»„-å¤ªææ‹³" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å¤ªææ‹³</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="Bç»„-å‰‘" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å‰‘</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="Bç»„-æª" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">æª</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="Bç»„-åˆ€" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">åˆ€</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="Bç»„-æ£" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">æ£</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="Bç»„-å—åˆ€" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å—åˆ€</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="Bç»„-å—æ£" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å—æ£</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="Bç»„-å¤ªæå‰‘" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å¤ªæå‰‘</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="Bç»„-å¤ªææ‰‡" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å¤ªææ‰‡</span>
                            </label>
                        </div>
                    </div>

                    <!-- Group A -->
                    <div class="border-l-4 border-purple-600 bg-purple-50 rounded-r-xl p-4">
                        <h3 class="font-bold text-purple-800 mb-3">Aç»„ Group A</h3>
                        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2">
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="Aç»„-é•¿æ‹³" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">é•¿æ‹³</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="Aç»„-å—æ‹³" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å—æ‹³</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="Aç»„-å¤ªææ‹³" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å¤ªææ‹³</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="Aç»„-å‰‘" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å‰‘</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="Aç»„-æª" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">æª</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="Aç»„-åˆ€" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">åˆ€</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="Aç»„-æ£" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">æ£</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="Aç»„-å—åˆ€" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å—åˆ€</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="Aç»„-å—æ£" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å—æ£</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="Aç»„-å¤ªæå‰‘" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å¤ªæå‰‘</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="Aç»„-å¤ªææ‰‡" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å¤ªææ‰‡</span>
                            </label>
                        </div>
                    </div>

                    <!-- Optional Level -->
                    <div class="border-l-4 border-amber-600 bg-amber-50 rounded-r-xl p-4">
                        <h3 class="font-bold text-amber-800 mb-3">è‡ªé€‰ Optional</h3>
                        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2">
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="è‡ªé€‰-é•¿æ‹³" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">é•¿æ‹³</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="è‡ªé€‰-å—æ‹³" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å—æ‹³</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="è‡ªé€‰-å¤ªææ‹³" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å¤ªææ‹³</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="è‡ªé€‰-å‰‘" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å‰‘</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="è‡ªé€‰-æª" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">æª</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="è‡ªé€‰-åˆ€" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">åˆ€</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="è‡ªé€‰-æ£" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">æ£</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="è‡ªé€‰-å—åˆ€" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å—åˆ€</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="è‡ªé€‰-å—æ£" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å—æ£</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="è‡ªé€‰-å¤ªæå‰‘" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å¤ªæå‰‘</span>
                            </label>
                            <label class="cursor-pointer flex items-center gap-2">
                                <input type="checkbox" name="evt" value="è‡ªé€‰-å¤ªææ‰‡" class="w-4 h-4 text-amber-500 rounded">
                                <span class="text-sm">å¤ªææ‰‡</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- STEP 4: Schedule -->
            <!-- STEP 4: Schedule (Simplified & Validated) -->
<div id="step-4" class="step-content">
    <h2 class="text-xl font-bold text-slate-800 mb-6 flex items-center gap-2">
        <i class="fa-regular fa-calendar-check text-amber-500"></i> è®­ç»ƒæ—¶é—´ Training Schedule
    </h2>

    <!-- Fee Info -->
    <div class="bg-amber-50 text-amber-900 p-4 rounded-xl text-xs mb-8 border border-amber-100">
        <p class="font-bold mb-1"><i class="fas fa-info-circle"></i>å‡¡é€‰æ‹©é¡¹ç›®ï¼Œæ—¥æœŸ ğŸ“… ä¸é”»ç‚¼åœ°ç‚¹ ğŸ“ å¯è‡ªé€‰<br>Choose your program, date ğŸ“…, and training location ğŸ“ freely</p>
        <p>å­¦è´¹å¦‚ä¸‹ Fees:</p>
        <p>â€¢ æ¯æœˆï¼ˆæ¯å‘¨ä¸€å ‚è¯¾ï¼‰Monthly (1 class per week)<strong> RM 120</strong></p>
        <p>â€¢ æ¯æœˆï¼ˆæ¯å‘¨ä¸¤å ‚è¯¾ï¼‰Monthly (2 class per week)<strong> RM 220</strong></p>
        <p>â€¢ æ¯æœˆï¼ˆæ¯å‘¨ä¸‰å ‚è¯¾ï¼‰Monthly (3 class per week)<strong> RM 280</strong></p>
    </div>

    <div class="space-y-8">
        <!-- LOCATION: SJKC -->
        <div>
            <h3 class="text-sm font-bold text-slate-900 uppercase tracking-wider border-b border-slate-200 pb-2 mb-3">
                ğŸ“ SJK(C) Puay Chai 2 <span class="text-slate-400 font-normal text-xs ml-2">Bandar Utama</span>
            </h3>
            <label class="flex items-start p-3 rounded-lg hover:bg-slate-50 cursor-pointer transition-colors group">
    <input type="checkbox" name="sch" value="SJK(C) Puay Chai 2: Tue 8pm-10pm" class="mt-1 w-4 h-4 text-amber-500 rounded border-slate-300 focus:ring-amber-500">
    <div class="ml-3">
        <div class="text-sm font-bold text-slate-700 group-hover:text-amber-600 transition-colors">Tuesday æ˜ŸæœŸäºŒ Â· 8:00 PM - 10:00 PM</div>
        <div class="text-xs text-slate-500 mt-0.5">
            <span class="bg-blue-100 text-blue-800 px-2 py-0.5 rounded-md font-semibold">åªé™äºå·é˜Ÿ/åå¤‡é˜Ÿ Only for State/Backup Team</span>
            <span class="text-slate-400 ml-1">(D/C/B/A å¥—è·¯ Routine)</span>
        </div>
        <div class="text-[10px] text-red-500 font-bold hidden disabled-msg">ğŸš« Not available for Normal Students æ™®é€šå­¦ç”Ÿä¸å…è®¸å‚åŠ </div>
    </div>
</label>
        </div>

        <!-- LOCATION: WSA -->
        <div>
            <h3 class="text-sm font-bold text-slate-900 uppercase tracking-wider border-b border-slate-200 pb-2 mb-3">
                ğŸ“ Wushu Sport Academy <span class="text-slate-400 font-normal text-xs ml-2">Bukit Puchong</span>
            </h3>
            
            <div class="space-y-1">
                <label class="flex items-start p-3 rounded-lg hover:bg-slate-50 cursor-pointer transition-colors group">
                    <input type="checkbox" name="sch" value="Wushu Sport Academy: Sun 10am-12pm" class="mt-1 w-4 h-4 text-amber-500 rounded border-slate-300 focus:ring-amber-500">
                    <div class="ml-3">
                        <div class="text-sm font-bold text-slate-700 group-hover:text-amber-600 transition-colors">Sunday æ˜ŸæœŸæ—¥ Â· 10:00 AM - 12:00 PM</div>
                        <div class="text-xs text-slate-500 mt-0.5">
                            <span class="bg-blue-100 text-blue-800 px-2 py-0.5 rounded-md font-semibold">åªé™äºå·é˜Ÿ/åå¤‡é˜Ÿ Only for State/Backup Team</span>
                            </div>
                        <div class="text-[10px] text-red-500 font-bold hidden disabled-msg">ğŸš« Not available for Normal Students æ™®é€šå­¦ç”Ÿä¸å…è®¸å‚åŠ </div>
                    </div>
                </label>

                <label class="flex items-start p-3 rounded-lg hover:bg-slate-50 cursor-pointer transition-colors group">
                    <input type="checkbox" name="sch" value="Wushu Sport Academy: Sun 12pm-2pm" class="mt-1 w-4 h-4 text-amber-500 rounded border-slate-300 focus:ring-amber-500">
                    <div class="ml-3">
                        <div class="text-sm font-bold text-slate-700 group-hover:text-amber-600 transition-colors">Sunday æ˜ŸæœŸæ—¥ Â· 12:00 PM - 2:00 PM</div>
                    </div>
                </label>

                <label class="flex items-start p-3 rounded-lg hover:bg-slate-50 cursor-pointer transition-colors group">
                    <input type="checkbox" name="sch" value="Wushu Sport Academy: Wed 8pm-10pm" class="mt-1 w-4 h-4 text-amber-500 rounded border-slate-300 focus:ring-amber-500">
                    <div class="ml-3">
                        <div class="text-sm font-bold text-slate-700 group-hover:text-amber-600 transition-colors">Wednesday æ˜ŸæœŸä¸‰ Â· 8:00 PM - 10:00 PM</div>
                        <div class="text-xs text-slate-500 mt-0.5">å…¨éƒ¨ç»„åˆ« All Groups (A/B/C/D, å¤ªæ Tai Chi, ä¼ ç»Ÿ Traditional)</div>
                    </div>
                </label>
            </div>
        </div>

        <!-- LOCATION: CHINWOO -->
        <div>
            <h3 class="text-sm font-bold text-slate-900 uppercase tracking-wider border-b border-slate-200 pb-2 mb-3">
                ğŸ“ Stadium Chinwoo <span class="text-slate-400 font-normal text-xs ml-2">Kuala Lumpur</span>
            </h3>
            <label class="flex items-start p-3 rounded-lg hover:bg-slate-50 cursor-pointer transition-colors group">
                <input type="checkbox" name="sch" value="Stadium Chinwoo: Sun 2pm-4pm" class="mt-1 w-4 h-4 text-amber-500 rounded border-slate-300 focus:ring-amber-500">
                <div class="ml-3">
                    <div class="text-sm font-bold text-slate-700 group-hover:text-amber-600 transition-colors">Sunday æ˜ŸæœŸæ—¥ Â· 2:00 PM - 4:00 PM</div>
                    <div class="text-xs text-slate-500 mt-0.5">
            <span class="bg-blue-100 text-blue-800 px-2 py-0.5 rounded-md font-semibold">åªé™äºå·é˜Ÿ/åå¤‡é˜Ÿ Only for State/Backup Team<br></span>
            <span class="bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded-md font-semibold">å­¦è´¹äº¤ç»™ç²¾æ­¦ Fees paid to Chinwoo</span>
            <span class="text-slate-400 ml-1">(C/B/A å¥—è·¯ Routine)</span>
        </div>
        <div class="text-[10px] text-red-500 font-bold hidden disabled-msg">ğŸš« Not available for Normal Students æ™®é€šå­¦ç”Ÿä¸å…è®¸å‚åŠ </div>
                </div>
            </label>
        </div>

        <!-- TAI CHI -->
        <div>
            <h3 class="text-sm font-bold text-emerald-700 uppercase tracking-wider border-b border-emerald-100 pb-2 mb-3">
                ğŸ“ Tai Chi Classes å¤ªæç­
            </h3>
            <div class="space-y-1">
                <label class="flex items-start p-3 rounded-lg hover:bg-emerald-50 cursor-pointer transition-colors group">
                    <input type="checkbox" name="sch" value="Tai Chi: SJK(C) Puay Chai 2 Fri 8pm-10pm" class="mt-1 w-4 h-4 text-emerald-500 rounded border-slate-300 focus:ring-emerald-500">
                    <div class="ml-3">
                        <div class="text-sm font-bold text-slate-700 group-hover:text-emerald-700 transition-colors">Friday æ˜ŸæœŸäº” Â· 8:00 PM (SJKC Puay Chai 2)</div>
                    </div>
                </label>
                <label class="flex items-start p-3 rounded-lg hover:bg-emerald-50 cursor-pointer transition-colors group">
                    <input type="checkbox" name="sch" value="Tai Chi: Wushu Sport Academy Sun 10am-12pm" class="mt-1 w-4 h-4 text-emerald-500 rounded border-slate-300 focus:ring-emerald-500">
                    <div class="ml-3">
                        <div class="text-sm font-bold text-slate-700 group-hover:text-emerald-700 transition-colors">Sunday æ˜ŸæœŸæ—¥ Â· 10:00 AM (Wushu Sport Academy)</div>
                    </div>
                </label>
            </div>
        </div>
    </div>
</div>



            <!-- STEP 5: Terms & Signature -->
            <div id="step-5" class="step-content">
                <h2 class="text-xl font-bold text-slate-800 mb-6 flex items-center gap-2">
                    <i class="fa-solid fa-file-signature text-amber-500"></i> æ¡æ¬¾ä¸åè®® Agreement
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r-lg">
                        <h4 class="font-bold text-blue-700 text-sm mb-1">å­¦è´¹ç¼´ä»˜ Â· Fee Payment</h4>
                        <p class="text-xs text-blue-800 leading-relaxed">
                            å­¦è´¹éœ€åœ¨æ¯æœˆ10å·ä¹‹å‰ç¼´ä»˜ï¼Œå¹¶ä¸”æŠŠæ”¶æ® (Receipt) æ›´æ–°ç»™æ•™ç»ƒä»¥åŠ Adminã€‚
                        </p>
                        <p class="text-xs text-blue-700 leading-relaxed mt-1">
                            Fees must be paid before the 10th of every month, and the receipt must be sent to the coach and admin.
                        </p>
                    </div>
                    <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded-r-lg">
                        <h4 class="font-bold text-red-700 text-sm mb-1">è¿åŠ¨å‘˜å®ˆåˆ™ Â· Code of Conduct</h4>
                        <p class="text-xs text-red-800 leading-relaxed">
                            ä¸¥å®ˆçºªå¾‹ï¼Œå¿…é¡»å®ˆæ—¶ï¼Œç¦æ­¢ç©è€ã€‚è¿åçºªå¾‹å°†è¢«åºŸé™¤å·é˜Ÿèµ„æ ¼ã€‚
                        </p>
                        <p class="text-xs text-red-700 leading-relaxed mt-1">
                            Athletes must be disciplined and punctual and are not allowed to play during training; violations may result in disqualification.
                        </p>
                    </div>
                </div>

                <div class="bg-white border border-slate-200 rounded-xl p-4 md:p-5 h-64 md:h-56 overflow-y-auto custom-scroll mb-6 text-xs leading-relaxed">
    <div class="flex items-center justify-center mb-4">
        <h4 class="font-bold text-slate-800 text-sm">
            ğŸ“‹ TERMS & CONDITIONS æ¡æ¬¾ä¸æ¡ä»¶
        </h4>
    </div>

    <ol class="space-y-4">
        <li class="flex items-start gap-2 md:gap-3">
            <div class="mt-0.5 h-5 w-5 md:h-6 md:w-6 rounded-full bg-slate-900 text-white flex items-center justify-center text-[10px] md:text-[11px] font-bold flex-shrink-0">1</div>
            <div class="space-y-1">
                <p class="text-[11px] md:text-[12px] text-slate-800 leading-relaxed">
                    æœ¬äººï¼ˆå­¦å‘˜/å®¶é•¿/ç›‘æŠ¤äººï¼‰ç¡®è®¤ä¸Šè¿°èµ„æ–™å±å®ã€‚
                </p>
                <p class="text-[11px] md:text-[12px] text-slate-600 leading-relaxed">
                    I, the student/parent/guardian, confirm that all information provided above is true and correct.
                </p>
            </div>
        </li>

        <li class="flex items-start gap-2 md:gap-3">
            <div class="mt-0.5 h-5 w-5 md:h-6 md:w-6 rounded-full bg-slate-900 text-white flex items-center justify-center text-[10px] md:text-[11px] font-bold flex-shrink-0">2</div>
            <div class="space-y-1">
                <p class="text-[11px] md:text-[12px] text-slate-800 leading-relaxed">
                    æœ¬äººæ˜ç™½æ­¦æœ¯æ˜¯ä¸€é¡¹å‰§çƒˆè¿åŠ¨ï¼Œå¹¶æ„¿æ„è‡ªè¡Œæ‰¿æ‹…è®­ç»ƒæœŸé—´å¯èƒ½å‘ç”Ÿçš„æ„å¤–é£é™©ã€‚
                </p>
                <p class="text-[11px] md:text-[12px] text-slate-600 leading-relaxed">
                    I understand that Wushu is a highâ€‘intensity sport and agree to bear any risk of injury during training.
                </p>
            </div>
        </li>

        <li class="flex items-start gap-2 md:gap-3">
            <div class="mt-0.5 h-5 w-5 md:h-6 md:w-6 rounded-full bg-slate-900 text-white flex items-center justify-center text-[10px] md:text-[11px] font-bold flex-shrink-0">3</div>
            <div class="space-y-1">
                <p class="text-[11px] md:text-[12px] text-slate-800 leading-relaxed">
                    å­¦é™¢æœ‰æƒåœ¨å¿…è¦æ—¶è°ƒæ•´è®­ç»ƒæ—¶é—´æˆ–åœ°ç‚¹ï¼Œå¹¶å°†æå‰é€šçŸ¥ã€‚
                </p>
                <p class="text-[11px] md:text-[12px] text-slate-600 leading-relaxed">
                    The Academy reserves the right to adjust training times or venues when necessary and will notify in advance.
                </p>
            </div>
        </li>

        <li class="flex items-start gap-2 md:gap-3">
            <div class="mt-0.5 h-5 w-5 md:h-6 md:w-6 rounded-full bg-slate-900 text-white flex items-center justify-center text-[10px] md:text-[11px] font-bold flex-shrink-0">4</div>
            <div class="space-y-1">
                <p class="text-[11px] md:text-[12px] text-slate-800 leading-relaxed">
                    å­¦è´¹ä¸€ç»ç¼´ä»˜ï¼Œæ¦‚ä¸é€€è¿˜ï¼ˆNonâ€‘refundableï¼‰ã€‚
                </p>
                <p class="text-[11px] md:text-[12px] text-slate-600 leading-relaxed">
                    Fees paid are strictly nonâ€‘refundable under all circumstances.
                </p>
            </div>
        </li>

        <li class="flex items-start gap-2 md:gap-3">
            <div class="mt-0.5 h-5 w-5 md:h-6 md:w-6 rounded-full bg-slate-900 text-white flex items-center justify-center text-[10px] md:text-[11px] font-bold flex-shrink-0">5</div>
            <div class="space-y-1">
                <p class="text-[11px] md:text-[12px] text-slate-800 leading-relaxed">
                    æœ¬äººåŒæ„éµå®ˆå­¦é™¢åŠæ•™ç»ƒçš„æ‰€æœ‰æŒ‡ç¤ºä¸å®‰æ’ã€‚
                </p>
                <p class="text-[11px] md:text-[12px] text-slate-600 leading-relaxed">
                    I agree to follow all instructions, rules, and arrangements set by the Academy and coaches.
                </p>
            </div>
        </li>

        <li class="flex items-start gap-2 md:gap-3">
            <div class="mt-0.5 h-5 w-5 md:h-6 md:w-6 rounded-full bg-slate-900 text-white flex items-center justify-center text-[10px] md:text-[11px] font-bold flex-shrink-0">6</div>
            <div class="space-y-1">
                <p class="text-[11px] md:text-[12px] text-slate-800 leading-relaxed">
                    åªé™äºæœ¬é™¢é€šçŸ¥å–æ¶ˆè¯¾ç¨‹ï¼Œå°†ä¼šå¦è¡Œå®‰æ’è¡¥è¯¾ï¼Œå®¶é•¿ä¸å…è®¸è‡ªè¡Œå–æ¶ˆè¯¾ç¨‹ã€‚
                </p>
                <p class="text-[11px] md:text-[12px] text-slate-600 leading-relaxed">
                    Replacement classes are only provided when the Academy cancels a session; parents may not cancel classes on their own.
                </p>
            </div>
        </li>

        <li class="flex items-start gap-2 md:gap-3">
            <div class="mt-0.5 h-5 w-5 md:h-6 md:w-6 rounded-full bg-slate-900 text-white flex items-center justify-center text-[10px] md:text-[11px] font-bold flex-shrink-0">7</div>
            <div class="space-y-1">
                <p class="text-[11px] md:text-[12px] text-slate-800 leading-relaxed">
                    å¦‚å­¦å‘˜å› ç—…æˆ–å…¶ä»–åŸå› æ— æ³•å‡ºå¸­è®­ç»ƒï¼Œå¿…é¡»å‘è¡Œæ”¿ä¸æ•™ç»ƒç”³è¯·è¯·å‡ï¼›æœªç»è®¸å¯çš„ç¼ºå¸­å°†è¢«è®°å½•ã€‚
                </p>
                <p class="text-[11px] md:text-[12px] text-slate-600 leading-relaxed">
                    If the student cannot attend due to sickness or other reasons, leave must be applied for with admin and coach; unapproved absences will be recorded.
                </p>
            </div>
        </li>

        <li class="flex items-start gap-2 md:gap-3">
            <div class="mt-0.5 h-5 w-5 md:h-6 md:w-6 rounded-full bg-slate-900 text-white flex items-center justify-center text-[10px] md:text-[11px] font-bold flex-shrink-0">8</div>
            <div class="space-y-1">
                <p class="text-[11px] md:text-[12px] text-slate-800 leading-relaxed">
                    å·é˜ŸåŠåå¤‡é˜Ÿå¿…é¡»å‡ºå¸­æ‰€æœ‰è®­ç»ƒï¼Œä¿æŒè‰¯å¥½æ€åº¦ï¼Œæ¥å—ä¸¥æ ¼è®­ç»ƒä¸è®­å¯¼ã€‚
                </p>
                <p class="text-[11px] md:text-[12px] text-slate-600 leading-relaxed">
                    Stateâ€‘team and reserve athletes must attend all training, maintain good attitude, and accept strict training and discipline.
                </p>
            </div>
        </li>

        <li class="flex items-start gap-2 md:gap-3">
            <div class="mt-0.5 h-5 w-5 md:h-6 md:w-6 rounded-full bg-slate-900 text-white flex items-center justify-center text-[10px] md:text-[11px] font-bold flex-shrink-0">9</div>
            <div class="space-y-1">
                <p class="text-[11px] md:text-[12px] text-slate-800 leading-relaxed">
                    å¦‚å› è„šå—ä¼¤ã€æ‰­ä¼¤æˆ–ç”Ÿç—…ï¼Œè¯·å‹¿å‹‰å¼ºå‡ºå¸­è®­ç»ƒï¼Œåæœè‡ªè´Ÿã€‚
                </p>
                <p class="text-[11px] md:text-[12px] text-slate-600 leading-relaxed">
                    Students with injuries or illness should not attend training; any consequences are at their own risk.
                </p>
            </div>
        </li>

        <li class="flex items-start gap-2 md:gap-3">
            <div class="mt-0.5 h-5 w-5 md:h-6 md:w-6 rounded-full bg-slate-900 text-white flex items-center justify-center text-[10px] md:text-[11px] font-bold flex-shrink-0">10</div>
            <div class="space-y-1">
                <p class="text-[11px] md:text-[12px] text-slate-800 leading-relaxed">
                    æœ¬é™¢ä¸è´Ÿè´£å­¦å‘˜åŠå®¶é•¿çš„ä»»ä½•è´µé‡è´¢ç‰©ã€‚
                </p>
                <p class="text-[11px] md:text-[12px] text-slate-600 leading-relaxed">
                    The Academy is not responsible for any valuables belonging to students or parents.
                </p>
            </div>
        </li>

        <li class="flex items-start gap-2 md:gap-3">
            <div class="mt-0.5 h-5 w-5 md:h-6 md:w-6 rounded-full bg-slate-900 text-white flex items-center justify-center text-[10px] md:text-[11px] font-bold flex-shrink-0">11</div>
            <div class="space-y-1">
                <p class="text-[11px] md:text-[12px] text-slate-800 leading-relaxed">
                    ä¸å…è®¸æ‰“æ¶ã€åµæ¶ã€æ€åº¦æ¶åŠ£æˆ–ä¸é…åˆè®­ç»ƒï¼Œå¦åˆ™å°†è¢«å–æ¶ˆå·é˜ŸåŠå­¦å‘˜èµ„æ ¼ã€‚
                </p>
                <p class="text-[11px] md:text-[12px] text-slate-600 leading-relaxed">
                    Fighting, quarrelling, poor attitude, or refusing to cooperate with training may result in removal from the state team and the Academy.
                </p>
            </div>
        </li>

        <li class="flex items-start gap-2 md:gap-3">
            <div class="mt-0.5 h-5 w-5 md:h-6 md:w-6 rounded-full bg-slate-900 text-white flex items-center justify-center text-[10px] md:text-[11px] font-bold flex-shrink-0">12</div>
            <div class="space-y-1">
                <p class="text-[11px] md:text-[12px] text-slate-800 leading-relaxed">
                    è®­ç»ƒæœŸé—´ä¸å…è®¸åƒé£Ÿç‰©ï¼Œåªèƒ½åœ¨ä¼‘æ¯æ—¶é—´å–æ°´ã€‚
                </p>
                <p class="text-[11px] md:text-[12px] text-slate-600 leading-relaxed">
                    Eating is not allowed during training; only drinking water during breaks is permitted.
                </p>
            </div>
        </li>

        <li class="flex items-start gap-2 md:gap-3">
            <div class="mt-0.5 h-5 w-5 md:h-6 md:w-6 rounded-full bg-slate-900 text-white flex items-center justify-center text-[10px] md:text-[11px] font-bold flex-shrink-0">13</div>
            <div class="space-y-1">
                <p class="text-[11px] md:text-[12px] text-slate-800 leading-relaxed">
                    å®¶é•¿ä¸å…è®¸å¹²æ¶‰æ•™ç»ƒæ‰€å®‰æ’çš„ä¸“ä¸šè®­ç»ƒè®¡åˆ’åŠçºªå¾‹ç®¡ç†ã€‚
                </p>
                <p class="text-[11px] md:text-[12px] text-slate-600 leading-relaxed">
                    Parents are not allowed to interfere with professional training plans or discipline set by the coaches.
                </p>
            </div>
        </li>

        <li class="flex items-start gap-2 md:gap-3">
            <div class="mt-0.5 h-5 w-5 md:h-6 md:w-6 rounded-full bg-slate-900 text-white flex items-center justify-center text-[10px] md:text-[11px] font-bold flex-shrink-0">14</div>
            <div class="space-y-1">
                <p class="text-[11px] md:text-[12px] text-slate-800 leading-relaxed">
                    å®¶é•¿å¿…é¡»å‡†æ—¶è½½é€å­©å­å¾€è¿”è®­ç»ƒåœ°ç‚¹ï¼Œå¹¶è‡ªè¡Œè´Ÿè´£äº¤é€šå®‰å…¨ã€‚
                </p>
                <p class="text-[11px] md:text-[12px] text-slate-600 leading-relaxed">
                    Parents must send and pick up their children on time and are fully responsible for transport safety.
                </p>
            </div>
        </li>

        <li class="flex items-start gap-2 md:gap-3">
            <div class="mt-0.5 h-5 w-5 md:h-6 md:w-6 rounded-full bg-slate-900 text-white flex items-center justify-center text-[10px] md:text-[11px] font-bold flex-shrink-0">15</div>
            <div class="space-y-1">
                <p class="text-[11px] md:text-[12px] text-slate-800 leading-relaxed">
                    è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå­¦å‘˜å¯èƒ½è¢«å½•å½±æˆ–æ‹ç…§ä½œä¸ºå®£ä¼ ç”¨é€”ï¼Œå¦‚å®¶é•¿ä¸å…è®¸ï¼Œé¡»ä»¥ä¹¦é¢é€šçŸ¥æœ¬é™¢ã€‚
                </p>
                <p class="text-[11px] md:text-[12px] text-slate-600 leading-relaxed">
                    Training sessions may be recorded or photographed for publicity; parents who do not consent must inform the Academy in writing.
                </p>
            </div>
        </li>
    </ol>
</div>


                <div class="bg-slate-50 border border-slate-200 rounded-xl p-5 mt-6">
                    <h4 class="font-bold text-slate-700 mb-4 text-sm uppercase">Legal Declaration</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="text-xs font-bold text-slate-500">Parent Name</label>
                            <input type="text" id="parent-name" class="w-full p-2 border border-slate-300 rounded-lg text-sm bg-white">
                        </div>
                        <div>
                            <label class="text-xs font-bold text-slate-500">Parent IC No.</label>
                            <input type="text" id="parent-ic" class="w-full p-2 border border-slate-300 rounded-lg text-sm bg-white" placeholder="000000-00-0000" maxlength="14">
                        </div>
                        <div class="md:col-span-2">
                            <label class="text-xs font-bold text-slate-500">Effective Date</label>
                            <input type="text" id="today-date" class="w-full p-2 border border-slate-200 bg-slate-100 text-slate-500 rounded-lg text-sm" readonly>
                        </div>
                    </div>

                    <label class="text-xs font-bold text-slate-500 mb-2 block">Parent's Signature (Sign Below)</label>
                    <div id="sig-wrapper" class="sig-box">
                        <div id="sig-placeholder">SIGN HERE</div>
                        <div class="absolute top-2 right-2 z-10">
                            <button type="button" onclick="clearSig()" class="bg-red-100 text-red-600 px-3 py-1 rounded text-xs font-bold hover:bg-red-200 cursor-pointer border-none">
                                <i class="fa-solid fa-eraser"></i> Clear
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- STEP 6: Success Page -->
<div id="step-6" class="step-content">
    <div class="text-center py-12">
        <div class="mb-6">
            <div class="mx-auto w-24 h-24 bg-green-100 rounded-full flex items-center justify-center mb-4">
                <i class="fas fa-check-circle text-green-600 text-5xl"></i>
            </div>
            <h2 class="text-3xl font-bold text-slate-800 mb-2">Registration Successful!</h2>
            <p class="text-slate-600 text-lg mb-1">æŠ¥åæˆåŠŸï¼</p>
        </div>
        
        <div class="bg-blue-50 border-l-4 border-blue-500 p-6 rounded-r-xl mb-8 max-w-2xl mx-auto text-left">
            <h3 class="font-bold text-blue-800 mb-3 flex items-center gap-2">
                <i class="fas fa-info-circle"></i>
                What's Next? æ¥ä¸‹æ¥åšä»€ä¹ˆï¼Ÿ
            </h3>
            <ul class="space-y-2 text-sm text-blue-900">
                <li class="flex items-start gap-2">
                    <i class="fas fa-check text-blue-600 mt-1"></i>
                    <span>Your registration form has been submitted and signed agreement downloaded. æ‚¨çš„æŠ¥åè¡¨å·²æäº¤ï¼Œç­¾ç½²åè®®å·²ä¸‹è½½ã€‚</span>
                </li>
                <li class="flex items-start gap-2">
                    <i class="fas fa-check text-blue-600 mt-1"></i>
                    <span>Please pay the fees before the 10th of every month. è¯·åœ¨æ¯æœˆ10å·å‰ç¼´è´¹ã€‚</span>
                </li>
                <li class="flex items-start gap-2">
                    <i class="fas fa-check text-blue-600 mt-1"></i>
                    <span>Send your payment receipt to the coach and admin. å°†æ”¶æ®å‘ç»™æ•™ç»ƒå’Œè¡Œæ”¿äººå‘˜ã€‚</span>
                </li>
                <li class="flex items-start gap-2">
                    <i class="fas fa-check text-blue-600 mt-1"></i>
                    <span>Check your email for confirmation and training schedule details. æŸ¥çœ‹ç”µå­é‚®ä»¶ä»¥ç¡®è®¤è®­ç»ƒæ—¶é—´å®‰æ’ã€‚</span>
                </li>
            </ul>
        </div>

        <div class="flex justify-center">
            <button type="button" onclick="submitAnother()" class="bg-gradient-to-r from-purple-600 to-purple-700 text-white px-10 py-5 rounded-xl font-bold text-lg shadow-lg hover:from-purple-700 hover:to-purple-800 transition-all transform hover:scale-105 flex items-center gap-3">
                <i class="fas fa-plus-circle text-2xl"></i>
                <div class="text-left">
                    <div>Submit Another Registration</div>
                    <div class="text-sm font-normal">æäº¤å¦ä¸€ä»½æŠ¥åè¡¨</div>
                </div>
            </button>
        </div>
    </div>
</div>


        </form>
    </div>

    <!-- Footer buttons -->
    <div class="p-6 bg-white border-t border-slate-100 flex justify-between items-center">
        <button id="btn-prev" onclick="changeStep(-1)" class="px-6 py-2.5 rounded-xl font-semibold text-slate-500 hover:bg-slate-100 transition disabled:opacity-0" disabled>Back</button>
        <button id="btn-next" onclick="changeStep(1)" class="bg-slate-900 text-white px-8 py-2.5 rounded-xl font-semibold shadow-lg shadow-slate-300 hover:bg-slate-800 transition">
            Next Step <i class="fa-solid fa-arrow-right"></i>
        </button>
    </div>
</div>

<!-- HIDDEN PDF TEMPLATE - PAGE 1 -->
<div id="pdf-template-page1" style="width: 794px; padding: 40px; background: #ffffff; position: fixed; top: -10000px; left: -10000px; visibility: hidden; pointer-events: none; color: #111827; font-family: 'Noto Sans SC', sans-serif;">
    <img src="/assets/WSP Letter.png" style="width: 100%; margin-bottom: 12px;" alt="Letterhead">
    <h1 style="text-align:center; font-size:24px; font-weight:800; margin-top:6px;">OFFICIAL WUSHU REGISTRATION 2026</h1>
    <p style="text-align:center; font-size:13px; color:#6b7280; margin-bottom:24px;">Legal Binding Document Â· This form confirms participation in Wushu Sports Academy programmes.</p>

    <div style="margin-bottom:22px;">
        <div style="background:#e5e7eb; padding:7px 12px; font-weight:700; font-size:13px; text-transform:uppercase;">STUDENT DETAILS / å­¦å‘˜èµ„æ–™</div>
        <div style="border:1px solid #e5e7eb; border-top:none; padding:10px 12px; font-size:13px; line-height:1.5;">
            <div style="margin-bottom:5px;"><span style="font-weight:600; color:#6b7280; display:inline-block; width:140px;">Name å§“å:</span> <span style="font-weight:500; color:#111827;" id="pdf-name"></span></div>
            <div style="margin-bottom:5px;"><span style="font-weight:600; color:#6b7280; display:inline-block; width:140px;">IC No èº«ä»½è¯:</span> <span style="font-weight:500; color:#111827;" id="pdf-ic"></span></div>
            <div style="margin-bottom:5px;"><span style="font-weight:600; color:#6b7280; display:inline-block; width:140px;">Age å¹´é¾„:</span> <span style="font-weight:500; color:#111827;" id="pdf-age"></span></div>
            <div style="margin-bottom:5px;"><span style="font-weight:600; color:#6b7280; display:inline-block; width:140px;">School å­¦æ ¡:</span> <span style="font-weight:500; color:#111827;" id="pdf-school"></span></div>
            <div style="margin-bottom:5px;"><span style="font-weight:600; color:#6b7280; display:inline-block; width:140px;">Status èº«ä»½:</span> <span style="font-weight:500; color:#111827;" id="pdf-status"></span></div>
        </div>
    </div>

    <div style="margin-bottom:22px;">
        <div style="background:#e5e7eb; padding:7px 12px; font-weight:700; font-size:13px; text-transform:uppercase;">CONTACT & EVENTS / è”ç³»ä¸é¡¹ç›®</div>
        <div style="border:1px solid #e5e7eb; border-top:none; padding:10px 12px; font-size:13px; line-height:1.5;">
            <div style="margin-bottom:5px;"><span style="font-weight:600; color:#6b7280; display:inline-block; width:140px;">Phone ç”µè¯:</span> <span style="font-weight:500; color:#111827;" id="pdf-phone"></span></div>
            <div style="margin-bottom:5px;"><span style="font-weight:600; color:#6b7280; display:inline-block; width:140px;">Email é‚®ç®±:</span> <span style="font-weight:500; color:#111827;" id="pdf-email"></span></div>
            <div style="margin-bottom:5px;"><span style="font-weight:600; color:#6b7280; display:inline-block; width:140px;">Level ç­‰çº§:</span> <span style="font-weight:500; color:#111827;" id="pdf-level"></span></div>
            <div style="margin-bottom:5px;"><span style="font-weight:600; color:#6b7280; display:inline-block; width:140px;">Events é¡¹ç›®:</span> <span style="font-weight:500; color:#111827;" id="pdf-events"></span></div>
            <div style="margin-bottom:5px;"><span style="font-weight:600; color:#6b7280; display:inline-block; width:140px;">Schedule æ—¶é—´:</span> <span style="font-weight:500; color:#111827;" id="pdf-schedule"></span></div>
        </div>
    </div>

    <div style="margin-bottom:22px;">
        <div style="background:#e5e7eb; padding:7px 12px; font-weight:700; font-size:13px; text-transform:uppercase;">DECLARATION & SIGNATURE / å£°æ˜ä¸ç­¾å</div>
        <div style="border:1px solid #e5e7eb; border-top:none; padding:10px 12px; font-size:13px; line-height:1.5;">
            <p style="font-size:13px; margin-bottom:12px;">
                I hereby confirm that all information provided is accurate. I have read and agreed to the
                Terms & Conditions, Fee Policy, and Athlete Code of Conduct. I understand that Wushu is a
                high-intensity sport and agree to bear the risks involved.
            </p>
            <div style="border:1px solid #d1d5db; padding:8px; width:340px; height:130px; position:relative; margin-bottom:10px;">
                <img id="pdf-sig-img" style="max-width:100%; max-height:100%; object-fit:contain;">
            </div>
            <p style="font-size:13px; font-weight:600; margin-bottom:4px;">
                Parent / Guardian Name: <span id="pdf-parent-name"></span>
            </p>
            <p style="font-size:13px; font-weight:600; margin-bottom:4px;">
                Parent / Guardian IC No.: <span id="pdf-parent-ic"></span>
            </p>
            <p style="font-size:12px; margin-top:2px;">
                Date: <span id="pdf-date"></span>
            </p>
        </div>
    </div>

    <p style="font-size:12px; color:#4b5563; margin-top:14px; text-align:justify; line-height:1.6;">
        <strong>NOTES / å¤‡æ³¨ï¼š</strong>
        Fees are non-refundable and must be paid by the 10th of every month. Strict discipline and punctuality
        are required at all times. The Academy reserves the right to adjust training schedules and venues when
        necessary. å­¦è´¹æ¦‚ä¸é€€è¿˜ï¼Œå¹¶é¡»åœ¨æ¯æœˆ10å·å‰ç¼´æ¸…ã€‚å­¦å‘˜å¿…é¡»ä¸¥å®ˆçºªå¾‹ä¸å®ˆæ—¶ï¼›å­¦é™¢ä¿ç•™åœ¨æœ‰éœ€è¦æ—¶è°ƒæ•´è®­ç»ƒæ—¶é—´åŠåœ°ç‚¹çš„æƒåˆ©ã€‚
    </p>
</div>


<!-- HIDDEN PDF TEMPLATE - PAGE 2 -->
<div id="pdf-template-page2" style="width: 794px; padding: 40px; background: #ffffff; position: fixed; top: -10000px; left: -10000px; visibility: hidden; pointer-events: none; color: #111827; font-family: Arial, sans-serif;">
    <img src="/assets/WSP Letter.png" style="width: 100%; margin-bottom: 12px;" alt="Letterhead">
    <h1 style="text-align:center; font-size:24px; font-weight:800; margin-top:6px; font-family: 'Noto Sans SC', sans-serif;">TERMS & CONDITIONS</h1>
    <p style="text-align:center; font-size:13px; color:#6b7280; margin-bottom:16px; font-family: 'Noto Sans SC', sans-serif;">æ¡æ¬¾ä¸æ¡ä»¶ Â· Agreed and Signed by Parent/Guardian</p>

    <div style="font-size: 11px; line-height: 1.5; color: #111827; font-family: 'Noto Sans SC', sans-serif;">
        <p style="margin-bottom: 10px; font-weight: 600; color: #1e293b; font-size: 12px;">
            The parent/guardian has read, understood, and agreed to the following terms:
        </p>

        <table style="width: 100%; border-collapse: collapse;">
            <tr>
                <td style="width: 30px; padding: 0 8px 8px 0;">
                    <div style="width: 24px; height: 24px; background: #1e293b; border-radius: 50%; color: white; font-weight: 700; font-size: 12px; text-align: center; font-family: Arial, sans-serif; box-sizing: border-box; line-height: 10px;">1</div>
                </td>
                <td style="padding: 0 0 8px 0;">
                    <p style="margin: 0 0 2px 0; font-weight: 600; font-size: 11px; line-height: 1.4;">æœ¬äººï¼ˆå­¦å‘˜/å®¶é•¿/ç›‘æŠ¤äººï¼‰ç¡®è®¤ä¸Šè¿°èµ„æ–™å±å®ã€‚</p>
                    <p style="margin: 0; color: #4b5563; font-size: 10px; line-height: 1.4;">I, the student/parent/guardian, confirm that all information provided above is true and correct.</p>
                </td>
            </tr>
            <tr>
                <td style="width: 30px; padding: 0 8px 8px 0;">
                    <div style="width: 24px; height: 24px; background: #1e293b; border-radius: 50%; color: white; font-weight: 700; font-size: 12px; text-align: center; font-family: Arial, sans-serif; box-sizing: border-box; line-height: 10px;">2</div>
                </td>
                <td style="padding: 0 0 8px 0;">
                    <p style="margin: 0 0 2px 0; font-weight: 600; font-size: 11px; line-height: 1.4;">æœ¬äººæ˜ç™½æ­¦æœ¯æ˜¯ä¸€é¡¹å‰§çƒˆè¿åŠ¨ï¼Œå¹¶æ„¿æ„è‡ªè¡Œæ‰¿æ‹…è®­ç»ƒæœŸé—´å¯èƒ½å‘ç”Ÿçš„æ„å¤–é£é™©ã€‚</p>
                    <p style="margin: 0; color: #4b5563; font-size: 10px; line-height: 1.4;">I understand that Wushu is a highâ€‘intensity sport and agree to bear any risk of injury during training.</p>
                </td>
            </tr>
            <tr>
                <td style="width: 30px; padding: 0 8px 8px 0;">
                    <div style="width: 24px; height: 24px; background: #1e293b; border-radius: 50%; color: white; font-weight: 700; font-size: 12px; text-align: center; font-family: Arial, sans-serif; box-sizing: border-box; line-height: 10px;">3</div>
                </td>
                <td style="padding: 0 0 8px 0;">
                    <p style="margin: 0 0 2px 0; font-weight: 600; font-size: 11px; line-height: 1.4;">å­¦é™¢æœ‰æƒåœ¨å¿…è¦æ—¶è°ƒæ•´è®­ç»ƒæ—¶é—´æˆ–åœ°ç‚¹ï¼Œå¹¶å°†æå‰é€šçŸ¥ã€‚</p>
                    <p style="margin: 0; color: #4b5563; font-size: 10px; line-height: 1.4;">The Academy reserves the right to adjust training times or venues when necessary and will notify in advance.</p>
                </td>
            </tr>
            <tr>
                <td style="width: 30px; padding: 0 8px 8px 0;">
                    <div style="width: 24px; height: 24px; background: #1e293b; border-radius: 50%; color: white; font-weight: 700; font-size: 12px; text-align: center; font-family: Arial, sans-serif; box-sizing: border-box; line-height: 10px;">4</div>
                </td>
                <td style="padding: 0 0 8px 0;">
                    <p style="margin: 0 0 2px 0; font-weight: 600; font-size: 11px; line-height: 1.4;">å­¦è´¹ä¸€ç»ç¼´ä»˜ï¼Œæ¦‚ä¸é€€è¿˜ï¼ˆNonâ€‘refundableï¼‰ã€‚</p>
                    <p style="margin: 0; color: #4b5563; font-size: 10px; line-height: 1.4;">Fees paid are strictly nonâ€‘refundable under all circumstances.</p>
                </td>
            </tr>
            <tr>
                <td style="width: 30px; padding: 0 8px 8px 0;">
                    <div style="width: 24px; height: 24px; background: #1e293b; border-radius: 50%; color: white; font-weight: 700; font-size: 12px; text-align: center; font-family: Arial, sans-serif; box-sizing: border-box; line-height: 10px;">5</div>
                </td>
                <td style="padding: 0 0 8px 0;">
                    <p style="margin: 0 0 2px 0; font-weight: 600; font-size: 11px; line-height: 1.4;">æœ¬äººåŒæ„éµå®ˆå­¦é™¢åŠæ•™ç»ƒçš„æ‰€æœ‰æŒ‡ç¤ºä¸å®‰æ’ã€‚</p>
                    <p style="margin: 0; color: #4b5563; font-size: 10px; line-height: 1.4;">I agree to follow all instructions, rules, and arrangements set by the Academy and coaches.</p>
                </td>
            </tr>
            <tr>
                <td style="width: 30px; padding: 0 8px 8px 0;">
                    <div style="width: 24px; height: 24px; background: #1e293b; border-radius: 50%; color: white; font-weight: 700; font-size: 12px; text-align: center; font-family: Arial, sans-serif; box-sizing: border-box; line-height: 10px;">6</div>
                </td>
                <td style="padding: 0 0 8px 0;">
                    <p style="margin: 0 0 2px 0; font-weight: 600; font-size: 11px; line-height: 1.4;">åªé™äºæœ¬é™¢é€šçŸ¥å–æ¶ˆè¯¾ç¨‹ï¼Œå°†ä¼šå¦è¡Œå®‰æ’è¡¥è¯¾ï¼Œå®¶é•¿ä¸å…è®¸è‡ªè¡Œå–æ¶ˆè¯¾ç¨‹ã€‚</p>
                    <p style="margin: 0; color: #4b5563; font-size: 10px; line-height: 1.4;">Replacement classes are only provided when the Academy cancels a session; parents may not cancel classes on their own.</p>
                </td>
            </tr>
            <tr>
                <td style="width: 30px; padding: 0 8px 8px 0;">
                    <div style="width: 24px; height: 24px; background: #1e293b; border-radius: 50%; color: white; font-weight: 700; font-size: 12px; text-align: center; font-family: Arial, sans-serif; box-sizing: border-box; line-height: 10px;">7</div>
                </td>
                <td style="padding: 0 0 8px 0;">
                    <p style="margin: 0 0 2px 0; font-weight: 600; font-size: 11px; line-height: 1.4;">å¦‚å­¦å‘˜å› ç—…æˆ–å…¶ä»–åŸå› æ— æ³•å‡ºå¸­è®­ç»ƒï¼Œå¿…é¡»å‘è¡Œæ”¿ä¸æ•™ç»ƒç”³è¯·è¯·å‡ï¼›æœªç»è®¸å¯çš„ç¼ºå¸­å°†è¢«è®°å½•ã€‚</p>
                    <p style="margin: 0; color: #4b5563; font-size: 10px; line-height: 1.4;">If the student cannot attend due to sickness or other reasons, leave must be applied for with admin and coach; unapproved absences will be recorded.</p>
                </td>
            </tr>
            <tr>
                <td style="width: 30px; padding: 0 8px 8px 0;">
                    <div style="width: 24px; height: 24px; background: #1e293b; border-radius: 50%; color: white; font-weight: 700; font-size: 12px; text-align: center; font-family: Arial, sans-serif; box-sizing: border-box; line-height: 10px;">8</div>
                </td>
                <td style="padding: 0 0 8px 0;">
                    <p style="margin: 0 0 2px 0; font-weight: 600; font-size: 11px; line-height: 1.4;">å·é˜ŸåŠåå¤‡é˜Ÿå¿…é¡»å‡ºå¸­æ‰€æœ‰è®­ç»ƒï¼Œä¿æŒè‰¯å¥½æ€åº¦ï¼Œæ¥å—ä¸¥æ ¼è®­ç»ƒä¸è®­å¯¼ã€‚</p>
                    <p style="margin: 0; color: #4b5563; font-size: 10px; line-height: 1.4;">Stateâ€‘team and reserve athletes must attend all training, maintain good attitude, and accept strict training and discipline.</p>
                </td>
            </tr>
            <tr>
                <td style="width: 30px; padding: 0 8px 8px 0;">
                    <div style="width: 24px; height: 24px; background: #1e293b; border-radius: 50%; color: white; font-weight: 700; font-size: 12px; text-align: center; font-family: Arial, sans-serif; box-sizing: border-box; line-height: 10px;">9</div>
                </td>
                <td style="padding: 0 0 8px 0;">
                    <p style="margin: 0 0 2px 0; font-weight: 600; font-size: 11px; line-height: 1.4;">å¦‚å› è„šå—ä¼¤ã€æ‰­ä¼¤æˆ–ç”Ÿç—…ï¼Œè¯·å‹¿å‹‰å¼ºå‡ºå¸­è®­ç»ƒï¼Œåæœè‡ªè´Ÿã€‚</p>
                    <p style="margin: 0; color: #4b5563; font-size: 10px; line-height: 1.4;">Students with injuries or illness should not attend training; any consequences are at their own risk.</p>
                </td>
            </tr>
            <tr>
                <td style="width: 30px; padding: 0 8px 8px 0;">
                    <div style="width: 24px; height: 24px; background: #1e293b; border-radius: 50%; color: white; font-weight: 700; font-size: 12px; text-align: center; font-family: Arial, sans-serif; box-sizing: border-box; line-height: 10px;">10</div>
                </td>
                <td style="padding: 0 0 8px 0;">
                    <p style="margin: 0 0 2px 0; font-weight: 600; font-size: 11px; line-height: 1.4;">æœ¬é™¢ä¸è´Ÿè´£å­¦å‘˜åŠå®¶é•¿çš„ä»»ä½•è´µé‡è´¢ç‰©ã€‚</p>
                    <p style="margin: 0; color: #4b5563; font-size: 10px; line-height: 1.4;">The Academy is not responsible for any valuables belonging to students or parents.</p>
                </td>
            </tr>
            <tr>
                <td style="width: 30px; padding: 0 8px 8px 0;">
                    <div style="width: 24px; height: 24px; background: #1e293b; border-radius: 50%; color: white; font-weight: 700; font-size: 12px; text-align: center; font-family: Arial, sans-serif; box-sizing: border-box; line-height: 10px;">11</div>
                </td>
                <td style="padding: 0 0 8px 0;">
                    <p style="margin: 0 0 2px 0; font-weight: 600; font-size: 11px; line-height: 1.4;">ä¸å…è®¸æ‰“æ¶ã€åµæ¶ã€æ€åº¦æ¶åŠ£æˆ–ä¸é…åˆè®­ç»ƒï¼Œå¦åˆ™å°†è¢«å–æ¶ˆå·é˜ŸåŠå­¦å‘˜èµ„æ ¼ã€‚</p>
                    <p style="margin: 0; color: #4b5563; font-size: 10px; line-height: 1.4;">Fighting, quarrelling, poor attitude, or refusing to cooperate with training may result in removal from the state team and the Academy.</p>
                </td>
            </tr>
            <tr>
                <td style="width: 30px; padding: 0 8px 8px 0;">
                    <div style="width: 24px; height: 24px; background: #1e293b; border-radius: 50%; color: white; font-weight: 700; font-size: 12px; text-align: center; font-family: Arial, sans-serif; box-sizing: border-box; line-height: 10px;">12</div>
                </td>
                <td style="padding: 0 0 8px 0;">
                    <p style="margin: 0 0 2px 0; font-weight: 600; font-size: 11px; line-height: 1.4;">è®­ç»ƒæœŸé—´ä¸å…è®¸åƒé£Ÿç‰©ï¼Œåªèƒ½åœ¨ä¼‘æ¯æ—¶é—´å–æ°´ã€‚</p>
                    <p style="margin: 0; color: #4b5563; font-size: 10px; line-height: 1.4;">Eating is not allowed during training; only drinking water during breaks is permitted.</p>
                </td>
            </tr>
            <tr>
                <td style="width: 30px; padding: 0 8px 8px 0;">
                    <div style="width: 24px; height: 24px; background: #1e293b; border-radius: 50%; color: white; font-weight: 700; font-size: 12px; text-align: center; font-family: Arial, sans-serif; box-sizing: border-box; line-height: 10px;">13</div>
                </td>
                <td style="padding: 0 0 8px 0;">
                    <p style="margin: 0 0 2px 0; font-weight: 600; font-size: 11px; line-height: 1.4;">å®¶é•¿ä¸å…è®¸å¹²æ¶‰æ•™ç»ƒæ‰€å®‰æ’çš„ä¸“ä¸šè®­ç»ƒè®¡åˆ’åŠçºªå¾‹ç®¡ç†ã€‚</p>
                    <p style="margin: 0; color: #4b5563; font-size: 10px; line-height: 1.4;">Parents are not allowed to interfere with professional training plans or discipline set by the coaches.</p>
                </td>
            </tr>
            <tr>
                <td style="width: 30px; padding: 0 8px 8px 0;">
                    <div style="width: 24px; height: 24px; background: #1e293b; border-radius: 50%; color: white; font-weight: 700; font-size: 12px; text-align: center; font-family: Arial, sans-serif; box-sizing: border-box; line-height: 10px;">14</div>
                </td>
                <td style="padding: 0 0 8px 0;">
                    <p style="margin: 0 0 2px 0; font-weight: 600; font-size: 11px; line-height: 1.4;">å®¶é•¿å¿…é¡»å‡†æ—¶è½½é€å­©å­å¾€è¿”è®­ç»ƒåœ°ç‚¹ï¼Œå¹¶è‡ªè¡Œè´Ÿè´£äº¤é€šå®‰å…¨ã€‚</p>
                    <p style="margin: 0; color: #4b5563; font-size: 10px; line-height: 1.4;">Parents must send and pick up their children on time and are fully responsible for transport safety.</p>
                </td>
            </tr>
            <tr>
                <td style="width: 30px; padding: 0 8px 8px 0;">
                    <div style="width: 24px; height: 24px; background: #1e293b; border-radius: 50%; color: white; font-weight: 700; font-size: 12px; text-align: center; font-family: Arial, sans-serif; box-sizing: border-box; line-height: 10px;">15</div>
                </td>
                <td style="padding: 0 0 8px 0;">
                    <p style="margin: 0 0 2px 0; font-weight: 600; font-size: 11px; line-height: 1.4;">è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå­¦å‘˜å¯èƒ½è¢«å½•å½±æˆ–æ‹ç…§ä½œä¸ºå®£ä¼ ç”¨é€”ï¼Œå¦‚å®¶é•¿ä¸å…è®¸ï¼Œé¡»ä»¥ä¹¦é¢é€šçŸ¥æœ¬é™¢ã€‚</p>
                    <p style="margin: 0; color: #4b5563; font-size: 10px; line-height: 1.4;">Training sessions may be recorded or photographed for publicity; parents who do not consent must inform the Academy in writing.</p>
                </td>
            </tr>
        </table>

        <div style="margin-top: 18px; padding: 14px 16px; background: #f8fafc; border: 2px solid #1e293b; border-radius: 6px;">
            <p style="font-weight: 700; margin: 0 0 8px 0; color: #1e293b; font-size: 12px;">LEGAL ACKNOWLEDGEMENT / æ³•å¾‹å£°æ˜</p>
            <p style="margin: 0 0 6px 0; font-size: 10.5px; line-height: 1.5;">
                By signing this document, the parent/guardian acknowledges that they have read, understood, and agreed to all 15 terms and conditions listed above.
            </p>
            <p style="color: #4b5563; font-size: 10px; margin: 0 0 10px 0; line-height: 1.5;">
                å®¶é•¿/ç›‘æŠ¤äººç­¾ç½²æ­¤æ–‡ä»¶ï¼Œå³è¡¨ç¤ºå·²é˜…è¯»ã€ç†è§£å¹¶åŒæ„ä¸Šè¿°æ‰€æœ‰15é¡¹æ¡æ¬¾ä¸æ¡ä»¶ã€‚
            </p>
            <p style="margin: 0; font-weight: 600; font-size: 11px; line-height: 1.6;">
                Signed by: <span id="pdf-parent-name-2" style="font-weight: 500;"></span> (<span id="pdf-parent-ic-2" style="font-weight: 500;"></span>)<br>
                Date: <span id="pdf-date-2" style="font-weight: 500;"></span>
            </p>
        </div>
    </div>
</div>




<!-- LOADING OVERLAY -->
<div id="pdf-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 9999; justify-content: center; align-items: center;">
    <div style="text-align: center; color: white;">
        <div style="width: 60px; height: 60px; border: 5px solid rgba(255,255,255,0.3); border-top: 5px solid white; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 20px;"></div>
        <h3 style="font-size: 20px; margin: 0;">Generating Signed Agreement...</h3>
        <p style="margin-top: 10px; font-size: 14px; opacity: 0.8;">Please wait</p>
    </div>
</div>


<script>
    let currentStep = 1;
    const totalSteps = 6;

    let canvas, ctx;
    let isDrawing = false;
    let lastX = 0, lastY = 0;
    let hasSigned = false;

    const pdfOverlay = document.getElementById('pdf-overlay');

    // Store registration data for re-downloading
    let registrationData = null;

    document.addEventListener("DOMContentLoaded", function() {
    document.getElementById('today-date').value = new Date().toLocaleDateString('en-GB');
    document.getElementById('ic').addEventListener('input', formatIC);
    document.getElementById('ic').addEventListener('input', calculateAge);  // ADD THIS LINE
    document.getElementById('parent-ic').addEventListener('input', formatIC);
    document.getElementById('phone').addEventListener('input', formatPhone);
    document.getElementById('today-date').value = new Date().toLocaleDateString('en-GB');
    document.getElementById('ic').addEventListener('input', formatIC);
    document.getElementById('ic').addEventListener('input', calculateAge);
    document.getElementById('phone').addEventListener('input', formatPhone);
    initSignaturePad();
    window.addEventListener('resize', resizeCanvas);

    // --- NEW: Add Listeners for Status Change ---
    const statusRadios = document.getElementsByName('status');
    statusRadios.forEach(radio => {
        radio.addEventListener('change', updateScheduleAvailability);
    });

    // Run once on load to set initial state
    updateScheduleAvailability();
    window.addEventListener('resize', resizeCanvas);
});

    // Function to handle class restrictions based on Student Status
function updateScheduleAvailability() {
    // 1. Get current status
    const statusRadios = document.getElementsByName('status');
    let selectedStatus = 'Student å­¦ç”Ÿ'; // Default
    for (const radio of statusRadios) {
        if (radio.checked) {
            selectedStatus = radio.value;
            break;
        }
    }

    // Check if user is JUST a "Student" (not State or Backup)
    const isRegularStudent = selectedStatus === 'Student å­¦ç”Ÿ';

    // 2. Define the restricted values
    const restrictedClasses = [
        "SJK(C) Puay Chai 2: Tue 8pm-10pm",     // Tuesday Class
        "Wushu Sport Academy: Sun 10am-12pm",   // Sunday 10am Class
        "Stadium Chinwoo: Sun 2pm-4pm"          // Chinwoo Class
    ];

    // 3. Loop through restricted classes and disable/enable them
    restrictedClasses.forEach(val => {
        // Find the checkbox by value
        const checkbox = document.querySelector(`input[name="sch"][value="${val}"]`);
        
        if (checkbox) {
            const container = checkbox.closest('label');
            const errorMsg = container.querySelector('.disabled-msg');

            if (isRegularStudent) {
                // DISABLE logic
                checkbox.checked = false; // Uncheck if previously selected
                checkbox.disabled = true;
                
                // Visual updates
                container.classList.add('opacity-50', 'cursor-not-allowed', 'bg-slate-100');
                container.classList.remove('hover:bg-slate-50', 'cursor-pointer');
                if(errorMsg) errorMsg.classList.remove('hidden');
            } else {
                // ENABLE logic
                checkbox.disabled = false;
                
                // Visual updates
                container.classList.remove('opacity-50', 'cursor-not-allowed', 'bg-slate-100');
                container.classList.add('hover:bg-slate-50', 'cursor-pointer');
                if(errorMsg) errorMsg.classList.add('hidden');
            }
        }
    });
}



    function formatIC(e) {
        let val = e.target.value.replace(/\D/g, '');
        if (val.length > 12) val = val.substring(0, 12);
        if (val.length > 8) {
            e.target.value = val.substring(0, 6) + '-' + val.substring(6, 8) + '-' + val.substring(8, 12);
        } else if (val.length > 6) {
            e.target.value = val.substring(0, 6) + '-' + val.substring(6, 8);
        } else {
            e.target.value = val;
        }
    }

    function formatPhone(e) {
        let val = e.target.value.replace(/\D/g, '');
        if (val.length > 11) val = val.substring(0, 11);
        if (val.length >= 11) {
            e.target.value = val.substring(0, 3) + '-' + val.substring(3, 7) + ' ' + val.substring(7, 11);
        } else if (val.length >= 10) {
            e.target.value = val.substring(0, 3) + '-' + val.substring(3, 6) + ' ' + val.substring(6, 10);
        } else if (val.length > 3) {
            e.target.value = val.substring(0, 3) + '-' + val.substring(3);
        } else {
            e.target.value = val;
        }
    }
    
    function calculateAge() {
    const ic = document.getElementById('ic').value;
    const ageInput = document.getElementById('age');
    
    if (ic.length >= 6) {
        const year = ic.substring(0, 2);
        const month = ic.substring(2, 4);
        const day = ic.substring(4, 6);
        
        let fullYear = parseInt(year);
        fullYear = fullYear > 25 ? 1900 + fullYear : 2000 + fullYear;
        
        const birthDate = new Date(fullYear, parseInt(month) - 1, parseInt(day));
        const today = new Date();
        let age = today.getFullYear() - birthDate.getFullYear();
        const monthDiff = today.getMonth() - birthDate.getMonth();
        
        if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
            age--;
        }
        
        // Validate logical age range
        if (age < 4) {
            ageInput.value = '';
            showError('Age must be at least 4 years old to register.');
            return;
        }
        
        if (age > 100) {
            ageInput.value = '';
            showError('Please check your IC number. The calculated age seems incorrect.');
            return;
        }
        
        ageInput.value = age;
    }
}

function showError(message) {
    const errorDiv = document.createElement('div');
    errorDiv.className = 'bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm mt-2';
    errorDiv.innerHTML = `<i class="fas fa-exclamation-circle mr-2"></i>${message}`;
    
    const ageInput = document.getElementById('age');
    const existingError = ageInput.parentElement.querySelector('.bg-red-50');
    if (existingError) existingError.remove();
    
    ageInput.parentElement.appendChild(errorDiv);
    setTimeout(() => errorDiv.remove(), 4000);
}


    function initSignaturePad() {
        const wrapper = document.getElementById('sig-wrapper');
        canvas = document.createElement('canvas');
        canvas.id = 'sigCanvas';
        canvas.style.display = 'block';
        canvas.style.cursor = 'crosshair';
        wrapper.appendChild(canvas);
        ctx = canvas.getContext('2d');

        canvas.addEventListener('mousedown', (e) => {
            const rect = canvas.getBoundingClientRect();
            startDraw(e.clientX - rect.left, e.clientY - rect.top);
        });
        canvas.addEventListener('mousemove', (e) => {
            const rect = canvas.getBoundingClientRect();
            moveDraw(e.clientX - rect.left, e.clientY - rect.top);
        });
        canvas.addEventListener('mouseup', stopDraw);
        canvas.addEventListener('mouseleave', stopDraw);

        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            const t = e.touches[0];
            const rect = canvas.getBoundingClientRect();
            startDraw(t.clientX - rect.left, t.clientY - rect.top);
        }, { passive: false });

        canvas.addEventListener('touchmove', (e) => {
            e.preventDefault();
            const t = e.touches[0];
            const rect = canvas.getBoundingClientRect();
            moveDraw(t.clientX - rect.left, t.clientY - rect.top);
        }, { passive: false });

        canvas.addEventListener('touchend', stopDraw);
        resizeCanvas();
    }

    function resizeCanvas() {
        if (!canvas) return;
        const wrapper = document.getElementById('sig-wrapper');
        const rect = wrapper.getBoundingClientRect();
        if (rect.width > 0 && rect.height > 0 && (canvas.width !== rect.width || canvas.height !== rect.height)) {
            canvas.width = rect.width;
            canvas.height = rect.height;
            ctx.lineWidth = 2;
            ctx.lineCap = 'round';
            ctx.strokeStyle = '#000';
        }
    }

    function startDraw(x, y) {
        isDrawing = true;
        hasSigned = true;
        document.getElementById('sig-placeholder').style.display = 'none';
        lastX = x;
        lastY = y;
    }

    function moveDraw(x, y) {
        if (!isDrawing) return;
        ctx.beginPath();
        ctx.moveTo(lastX, lastY);
        ctx.lineTo(x, y);
        ctx.stroke();
        lastX = x;
        lastY = y;
    }

    function stopDraw() { isDrawing = false; }

    function clearSig() {
        if (!ctx) return;
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        hasSigned = false;
        document.getElementById('sig-placeholder').style.display = 'flex';
    }

    function toggleOtherSchool() {
        const val = document.getElementById('school').value;
        document.getElementById('school-other').classList.toggle('hidden', val !== 'Others');
    }

    function changeStep(dir) {
        if (dir === 1 && !validateStep(currentStep)) return;
        
        // Handle Step 5 submit - generate PDF and go to Step 6
        if (currentStep === 5 && dir === 1) {
            submitAndGeneratePDF();
            return;
        }

        // Handle Download PDF button on Step 6
        if (currentStep === 6 && dir === 1) {
            downloadPDF();
            return;
        }
        
        document.getElementById(`step-${currentStep}`).classList.remove('active');
        currentStep += dir;
        document.getElementById(`step-${currentStep}`).classList.add('active');

        if (currentStep === 5) setTimeout(resizeCanvas, 50);

        const stepNum = currentStep < 10 ? `0${currentStep}` : currentStep;
        document.getElementById('step-counter').innerHTML = `${stepNum}<span class="text-slate-600 text-sm">/06</span>`;
        document.getElementById('progress-bar').style.width = `${(currentStep/totalSteps)*100}%`;

        const prevBtn = document.getElementById('btn-prev');
        prevBtn.disabled = currentStep === 1;
        prevBtn.style.opacity = currentStep === 1 ? '0' : '1';

        const nextBtn = document.getElementById('btn-next');
        nextBtn.innerHTML = 'Next Step <i class="fa-solid fa-arrow-right"></i>';
        nextBtn.className = "bg-slate-900 text-white px-8 py-2.5 rounded-xl font-semibold shadow-lg shadow-slate-300 hover:bg-slate-800 transition";
    }

    function validateStep(step) {
        const stepDiv = document.getElementById(`step-${step}`);
        const inputs = stepDiv.querySelectorAll('input:not(.hidden), select');
        let isValid = true;
        let errMsg = '';

        inputs.forEach(input => {
            if (input.type !== 'checkbox' && input.type !== 'radio' && !input.value.trim()) {
                input.classList.add('border-red-500');
                isValid = false;
            } else {
                input.classList.remove('border-red-500');
            }
        });

        if (step === 1) {
            const ic = document.getElementById('ic').value;
            if (ic.length !== 14) {
                isValid = false;
                errMsg = 'IC Number must be in 000000-00-0000 format.';
                document.getElementById('ic').classList.add('border-red-500');
            }
        }

        if (step === 2) {
            const phone = document.getElementById('phone').value;
            const email = document.getElementById('email').value;
            if (phone.length < 12) {
                isValid = false;
                errMsg = 'Invalid Phone Number format.';
                document.getElementById('phone').classList.add('border-red-500');
            }
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                isValid = false;
                errMsg = 'Invalid Email Address.';
                document.getElementById('email').classList.add('border-red-500');
            }
        }

        if (step === 3) {
            const checkedEvents = document.querySelectorAll('input[name="evt"]:checked');
            if (checkedEvents.length === 0) {
                isValid = false;
                errMsg = 'Please select at least one event.';
            }
        }

        if (step === 5) {
            const pic = document.getElementById('parent-ic').value;
            if (pic.length !== 14) {
                isValid = false;
                errMsg = 'Parent IC Number must be in 000000-00-0000 format.';
                document.getElementById('parent-ic').classList.add('border-red-500');
            }
            if (!hasSigned) {
                isValid = false;
                errMsg = 'Please sign in the box.';
            }
        }

        if (!isValid) {
            Swal.fire({ icon: 'error', title: 'Check Details', text: errMsg || 'Please fill in all required fields correctly.' });
        }

        return isValid;
    }

    async function submitAndGeneratePDF() {
        pdfOverlay.style.display = 'flex';

        const namePlain = document.getElementById('name-en').value.trim();
        const nameCn    = document.getElementById('name-cn').value.trim();
        const displayName = nameCn ? `${namePlain} (${nameCn})` : namePlain;

        const ic = document.getElementById('ic').value;
        const age = document.getElementById('age').value;
        const school = document.getElementById('school').value === 'Others'
            ? document.getElementById('school-other').value
            : document.getElementById('school').value;
        const status = document.querySelector('input[name="status"]:checked').value;
        const phone = document.getElementById('phone').value;
        const email = document.getElementById('email').value;
        
        const selectedEvents = Array.from(document.querySelectorAll('input[name="evt"]:checked')).map(cb => cb.value);
        const events = selectedEvents.join(', ');
        
        const levels = [...new Set(selectedEvents.map(evt => evt.split('-')[0]))].join(', ');
        const level = levels || 'Not specified';
        
        const schedule = Array.from(document.querySelectorAll('input[name="sch"]:checked')).map(cb => cb.value).join(', ');
        const parent = document.getElementById('parent-name').value;
        const parentIC = document.getElementById('parent-ic').value;
        const date = document.getElementById('today-date').value;

        // Store data for re-downloading
        registrationData = {
            displayName,
            namePlain,
            ic,
            age,
            school,
            status,
            phone,
            email,
            level,
            events,
            schedule,
            parent,
            parentIC,
            date,
            signature: canvas.toDataURL('image/png')
        };

        try {
            // Generate and download PDF automatically
            await generatePDFFile();

            // Save to database
            await saveRegistration({
                name_en: namePlain,
                name_cn: nameCn,
                ic,
                age,
                school,
                status,
                phone,
                email,
                level,
                events,
                schedule,
                parent_name: parent,
                parent_ic: parentIC,
                form_date: date,
                signature_base64: canvas.toDataURL('image/png')
            });

            pdfOverlay.style.display = 'none';
            
            // Go to success page (Step 6)
            document.getElementById('step-5').classList.remove('active');
            currentStep = 6;
            document.getElementById('step-6').classList.add('active');
            
            document.getElementById('step-counter').innerHTML = `06<span class="text-slate-600 text-sm">/06</span>`;
            document.getElementById('progress-bar').style.width = '100%';
            
            // Update buttons for Step 6
            document.getElementById('btn-prev').style.display = 'none';
            
            const nextBtn = document.getElementById('btn-next');
            nextBtn.style.display = 'block';
            nextBtn.innerHTML = '<i class="fa-solid fa-download mr-2"></i> Download Signed Agreement';
            nextBtn.className = "bg-green-600 text-white px-8 py-2.5 rounded-xl font-semibold shadow-lg shadow-green-200 hover:bg-green-700 transition";
            
        } catch (e) {
            console.error(e);
            pdfOverlay.style.display = 'none';
            Swal.fire({ 
                icon: 'error', 
                title: 'Error', 
                text: 'Failed to generate or save signed agreement. Please try again.' 
            });
        }
    }

    async function downloadPDF() {
        if (!registrationData) {
            Swal.fire({ icon: 'error', title: 'Error', text: 'No registration data found.' });
            return;
        }
        
        pdfOverlay.style.display = 'flex';
        
        try {
            await generatePDFFile();
            pdfOverlay.style.display = 'none';
        } catch (e) {
            console.error(e);
            pdfOverlay.style.display = 'none';
            Swal.fire({ icon: 'error', title: 'Error', text: 'Failed to download signed agreement.' });
        }
    }

    async function generatePDFFile() {
    if (!registrationData) return;

    const { displayName, namePlain, ic, age, school, status, phone, email, level, events, schedule, parent, parentIC, date, signature } = registrationData;

    // Fill Page 1 data
    document.getElementById('pdf-name').innerText = displayName;
    document.getElementById('pdf-ic').innerText = ic;
    document.getElementById('pdf-age').innerText = age;
    document.getElementById('pdf-school').innerText = school;
    document.getElementById('pdf-status').innerText = status;
    document.getElementById('pdf-phone').innerText = phone;
    document.getElementById('pdf-email').innerText = email;
    document.getElementById('pdf-level').innerText = level;
    document.getElementById('pdf-events').innerText = events;
    document.getElementById('pdf-schedule').innerText = schedule;
    document.getElementById('pdf-parent-name').innerText = parent;
    document.getElementById('pdf-parent-ic').innerText = parentIC;
    document.getElementById('pdf-date').innerText = date;
    document.getElementById('pdf-sig-img').src = signature;

    // Fill Page 2 data
    document.getElementById('pdf-parent-name-2').innerText = parent;
    document.getElementById('pdf-parent-ic-2').innerText = parentIC;
    document.getElementById('pdf-date-2').innerText = date;

    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF('p', 'mm', 'a4');

    // Capture Page 1
    const page1 = document.getElementById('pdf-template-page1');
    page1.style.visibility = 'visible';

    const canvas1 = await html2canvas(page1, {
        scale: 2,
        useCORS: true,
        width: 794,
        height: 1123,
        logging: false
    });

    const imgData1 = canvas1.toDataURL('image/jpeg', 0.95);
    const pdfWidth = 210;
    const pdfHeight = 297;
    pdf.addImage(imgData1, 'JPEG', 0, 0, pdfWidth, pdfHeight);

    page1.style.visibility = 'hidden';

    // Capture Page 2
    const page2 = document.getElementById('pdf-template-page2');
    page2.style.visibility = 'visible';

    const canvas2 = await html2canvas(page2, {
        scale: 2,
        useCORS: true,
        width: 794,
        height: 1123,
        logging: false
    });

    const imgData2 = canvas2.toDataURL('image/jpeg', 0.95);
    pdf.addPage();
    pdf.addImage(imgData2, 'JPEG', 0, 0, pdfWidth, pdfHeight);

    page2.style.visibility = 'hidden';

    // Save PDF
    pdf.save(`${namePlain || 'Registration'}_Signed_Agreement.pdf`);
}



    async function saveRegistration(payload) {
        try {
            const res = await fetch('register.php', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });
            const json = await res.json();
            if (!json.success) {
                console.error('Save failed', json.error);
            }
        } catch (err) {
            console.error('Save error', err);
        }
    }

    function submitAnother() {
        document.getElementById('regForm').reset();
        clearSig();
        registrationData = null;
        
        for (let i = 1; i <= totalSteps; i++) {
            document.getElementById(`step-${i}`).classList.remove('active');
        }
        
        currentStep = 1;
        document.getElementById('step-1').classList.add('active');
        
        document.getElementById('step-counter').innerHTML = `01<span class="text-slate-600 text-sm">/06</span>`;
        document.getElementById('progress-bar').style.width = '16.67%';
        
        document.getElementById('btn-prev').style.display = 'block';
        document.getElementById('btn-prev').disabled = true;
        document.getElementById('btn-prev').style.opacity = '0';
        
        document.getElementById('btn-next').style.display = 'block';
        document.getElementById('btn-next').innerHTML = 'Next Step <i class="fa-solid fa-arrow-right"></i>';
        document.getElementById('btn-next').className = "bg-slate-900 text-white px-8 py-2.5 rounded-xl font-semibold shadow-lg shadow-slate-300 hover:bg-slate-800 transition";
        
        document.getElementById('today-date').value = new Date().toLocaleDateString('en-GB');
        
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }
</script>
</body>
</html>
